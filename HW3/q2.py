def egcd(a, b):
    x, y, u, v = 0, 1, 1, 0
    while a != 0:
        q, r = b//a, b % a
        m, n = x-u*q, y-v*q
        b, a, x, y, u, v = a, r, u, v, m, n
    gcd = b
    return gcd, x, y


def modinv(a, m):
    g, x, y = egcd(a, m)
    if g != 1:
        raise Exception('modular inverse does not exist')
    else:
        return x % m

cp = 591585661179913908292670964497762439966067617632980318594933696993454439728774695673398116279819100780981035776904828340000286556561821690365937795767595578460020372779099849512212679341203336712606691026980784826758612415894186878559418781933556513172143678225888892413399407357572102187313811291121304928928848821740914239643286098598943861830177312939795889893467307582185899931290683200944769576636703683519903565708396786917226998954212438208550716658336081133840312436400158765503544052687056167181841283624622810770703450396047554977193850903901459806510612970231465678503924692665502872536500180880428444652182260677241127037607744405052492742074626162505690986835662409717998630436892609085891138004339602274790886677062920378513594058185353516270486167595057731308599477294190461449818277150803142015005367485865449897543408948648598768730426058899226212982674326317239306732825540115470519539729209054092010428475270982133241739755670905018636775489391024836583829979747436647847343118308007690487133027090643538988141634837671142574166059246803646505989258216228280398544311438792645908159200659488745926355055587928710053702116250352855728835609501615125001498450195370742144016227930442188681846248774022591908284395554

cq=309411729251034251013395318719711706160811892862394890384299153591046151499917121473269348428595368341405902181095462992704329677547559777979434641542836057927150208356368122522229704600457038948359531454800468151991865398538394737136726928964793436886497125779317949812565735742165451557954880576255424560841686766527870866834024733826068596435927601933868356893971916253250737903827232908056159513671751051011444556858915046438167636879877207093812917634178160773097343436768913865449127177896443942872076146021042760369486915412609972874901144604578896888158193243455010603320402839406279239012820373216932302406828263523610721896771030364051463816982602691512661678520212734151948259164880771727519256923996762844291396810356605766709626469613406423888478179326659617558931774201308469110659393420333748745481493594465373505620910145316327984388627313690258503451934907257473375836215663070727820311136494801887688477512058462477531334799901621825205074964487431978969359431368816027376768643419649233036868068405017555516631026700926970709260767677416518151837286394000000084320497258684909083576218584531666178186869180867507209104151471590432167256468837661447181958281610404744566801864938311314315544802024261994226882434417

n=735129733350600300814682820983363975841858401155438497255664794289823750303771869563783060904740656108396832861631223213759233199110153841037374050058977286914202841273524024666932250131821113376668815406723621016490979772825337454765842227937701790973178644581429373241485573097140173355071014592912476993973876358900848501647208271118220494126859489227794428441209121779400263427064528800044153594488608641089810344852811969047683323752216047087315762593265636128466350649798266807305401826019476523383574373865654916089798354741168921810503521914845585839161180821237530439632455643648718893847945602507596343025039916399868955525098511955168845334399609780438491582190893008973851423386317328091461841967101793387569401290989098810214189082780241178398539863285659421612567764560272257730862326168958364031351936876932865703535175597367552038394861003656869677510780585595075450570568618061324321406580734938998169197647023586630354046716320331115546825940635140424868018161440043319003351900977331129699978699948137567053016132949764669941675005253460547841482625174892031076638216262945295769084071268327053819352242156952428409005165677559548048829999259603172407376651982303486619116704252671413990026284868294201399181512043

e = 65537


p = egcd(cp, n)[0]
q = egcd(cq, n)[0]

print("---- CORRECTNESS ----")
print(p*q == n)

print("---- P ----")
print(p)

print("---- Q ----")
print(q)

# We should find p = c^d mod(n)
# first find phi(n) = (p-1)*(q-1)

phi = (p-1)*(q-1)

# Now find d = e^-1 mod(n)
d = modinv(e, phi)


cm=410549325685366799284798358668331291049211237703447489321746464354090480951066742200309912524869634695769764148842963115769175527179769353501136785040366302701836605559269222653839509896223034315989474752525422032311356077141993653194048634554747064603617789881601934904375748720866525993835837380575119329831703593942313434602973137707915466599022298281760026130881260276637144571320608488322550304670024203670226128476075072338279764675774256431888736850559740563151465682499215963629918224101757068211315022934434916282345252224165558403932898552995551505591198395331625457165173901358070740812251352212374898226752191458989544999183050305396079595170576363831967410596235893058231852520802407515041647925479992058184613103289709752618729186509661786057001647083804585301703801272797236111687348907977621232083642431914363895266519463459112358271172160273751026080398345460929751476512586349360905588246751625224080678692961596943056437462453579785432258654674275520068227719175943507656108554707552928863240951458193510571735005767226590398204791730466993980158501690130104327829589781448607958503898902133445000532521723138230966914652700465728532524467483612403840506027543892612439531633794667013713638856396514285792898762678

# now find plaintext
ptext = pow(cm, d, n)
print("---- PTEXT ----")
print(ptext)
